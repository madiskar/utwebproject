function checkConnection(e){var t=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");t.open("HEAD","//"+window.location.hostname+"/?rand="+Math.floor(65536*(1+Math.random())),!1);try{t.send(),(t.status>=200&&t.status<300||304===t.status)&&window.localStorage&&(null==localStorage.getItem("connection")||"online"==localStorage.getItem("connection")?localStorage.setItem("connection","online"):setData())}catch(a){alert("You have no internet connection, you may resume but the changes you make will take effect after connection has been reestablished."),localStorage.setItem("connection","offline"),saveData(e)}}function saveData(e){if(localStorage.setItem("form",e),"reviewSubmit"==e&&(localStorage.setItem("review",$("#review").val()),localStorage.setItem("rating",$("#rating").val()),localStorage.setItem("user_id",$("#user_id").val()),localStorage.setItem("game_id",$("#game_id").val()),localStorage.setItem("game_slug",$("#game_slug").val())),"registerSubmit"==e&&(localStorage.setItem("username",$("#username").val()),localStorage.setItem("email",$("#email").val()),localStorage.setItem("password",$("#password").val()),localStorage.setItem("passConfirm",$("#passConfirm").val())),"addSubmit"==e&&(localStorage.setItem("title",$("#title").val()),localStorage.setItem("description",$("#description").val()),localStorage.setItem("thumbnail",$("#thumbnail").val()),localStorage.setItem("mainrev",$("#mainrev").val()),localStorage.setItem("screenshots",$("#screenshots").val()),localStorage.setItem("genreAction",$("#genreAction").val()),localStorage.setItem("genreAdventure",$("#genreAdventure").val()),localStorage.setItem("genreCasual",$("#genreCasual").val()),localStorage.setItem("genreIndie",$("#genreIndie").val()),localStorage.setItem("genreMMO",$("#genreMMO").val()),localStorage.setItem("genreRacing",$("#genreRacing").val()),localStorage.setItem("genreRPG",$("#genreRPG").val()),localStorage.setItem("genreSimulation",$("#genreSimulation").val()),localStorage.setItem("genreSports",$("#genreSports").val()),localStorage.setItem("genreStrategy",$("#genreStrategy").val()),localStorage.setItem("mainrating",$("#mainrating").val())),"changeAdmin"==e||"changeAllowed"==e){localStorage.removeItem("user"),localStorage.setItem("user",$("#user_id").val());var t=1==$("input[id|='"+$(this).attr("id")+"'][name|='admin']").is(":checked")?"1":"0";localStorage.setItem("admin",t);var a=1==$("input[id|='"+$(this).attr("id")+"'][name|='allowed']").is(":checked")?"1":"0";localStorage.setItem("allowed",a);var o=$(this).attr("id");localStorage.setItem("id",o)}}function setData(){if(localStorage.setItem("connection","online"),"reviewSubmit"==localStorage.getItem("form")){var e=new FormData;e.append("review",localStorage.getItem("review")),e.append("rating",localStorage.getItem("rating")),e.append("user_id",localStorage.getItem("user_id")),e.append("game_id",localStorage.getItem("game_id"));var t=new XMLHttpRequest;t.open("POST","http://wasdreviews.cs.ut.ee/index.php/games/"+localStorage.getItem("game_slug"),!0),t.send(e),t.onreadystatechange=function(){t.readyState==XMLHttpRequest.DONE},localStorage.removeItem("form"),localStorage.removeItem("review"),localStorage.removeItem("rating"),localStorage.removeItem("user_id"),localStorage.removeItem("game_id"),localStorage.removeItem("game_slug")}if("registerSubmit"==localStorage.getItem("form")){var e=new FormData;e.append("username",localStorage.getItem("username")),e.append("email",localStorage.getItem("email")),e.append("password",localStorage.getItem("password")),e.append("passConfirm",localStorage.getItem("passConfirm"));var t=new XMLHttpRequest;t.open("POST","http://wasdreviews.cs.ut.ee/index.php/register_controller",!0),t.send(e),t.onreadystatechange=function(){t.readyState==XMLHttpRequest.DONE},localStorage.removeItem("form"),localStorage.removeItem("username"),localStorage.removeItem("email"),localStorage.removeItem("password"),localStorage.removeItem("passConfirm")}if("addSubmit"==localStorage.getItem("form")){var e=new FormData;e.append("title",localStorage.getItem("title")),e.append("description",localStorage.getItem("description")),e.append("thumbnail",localStorage.getItem("thumbnail")),e.append("mainrev",localStorage.getItem("mainrev")),e.append("screenshots",localStorage.getItem("screenshots")),e.append("genreAction",localStorage.getItem("genreAction")),e.append("genreAdventure",localStorage.getItem("genreAdventure")),e.append("genreCasual",localStorage.getItem("genreCasual")),e.append("genreIndie",localStorage.getItem("genreIndie")),e.append("genreMMO",localStorage.getItem("genreMMO")),e.append("genreRPG",localStorage.getItem("genreRPG")),e.append("genreSimulation",localStorage.getItem("genreSimulation")),e.append("genreSports",localStorage.getItem("genreSports")),e.append("genreStrategy",localStorage.getItem("genreStrategy")),e.append("username",localStorage.getItem("mainrating"));var t=new XMLHttpRequest;t.open("POST","http://wasdreviews.cs.ut.ee/index.php/games/add",!0),t.send(e),t.onreadystatechange=function(){t.readyState==XMLHttpRequest.DONE},localStorage.removeItem("form"),localStorage.removeItem("title"),localStorage.removeItem("description"),localStorage.removeItem("thumbnail"),localStorage.removeItem("mainrev"),localStorage.removeItem("screenshots"),localStorage.removeItem("genreAction"),localStorage.removeItem("genreAdventure"),localStorage.removeItem("genreCasual"),localStorage.removeItem("genreIndie"),localStorage.removeItem("genreMMO"),localStorage.removeItem("genreRacing"),localStorage.removeItem("genreRPG"),localStorage.removeItem("genreSimulation"),localStorage.removeItem("genreSports"),localStorage.removeItem("genreStrategy"),localStorage.removeItem("mainrating")}if("changeAllowed"==localStorage.getItem("form")||"changeAdmin"==localStorage.getItem("form")){var e=new FormData;e.append("allowed",localStorage.getItem("allowed")),e.append("admin",localStorage.getItem("admin"));var t=new XMLHttpRequest;t.open("POST","http://wasdreviews.cs.ut.ee/index.php/admin/update_users/"+localStorage.getItem("id"),!0),t.send(e),localStorage.removeItem("form"),localStorage.removeItem("allowed"),localStorage.removeItem("admin"),localStorage.removeItem("user"),localStorage.removeItem("id")}}
function clearItems(){for(var e=document.getElementById("games");e.hasChildNodes();)e.removeChild(e.firstChild)}function buildHTML(e){for(var t=(window.location.origin,0);t<e.length;t++){var n=document.createElement("A");n.id="gamelink",n.href="http://wasdreviews.cs.ut.ee/index.php/games/"+e[t].slug;var a=document.createElement("div");a.id="container",a.className="gameContainer";var i=document.createElement("div");i.id="titleid",i.className="gameTitle",i.innerHTML=e[t].title;var d=document.createElement("div");d.id="gamedesc",d.className="gameDescription",d.innerHTML=e[t].description;var o=document.createElement("div");o.id="avgrating",o.className="gameRating",o.innerHTML="Hinnang: "+e[t].average_rating;var r=document.createElement("IMG");r.className="gameImage",r.alt=e[t].title+" ekraanipilt",r.src="http://wasdreviews.cs.ut.ee/public/images/"+e[t].slug+"/"+e[t].thmb_extension;var l=document.createElement("BR");a.appendChild(r),a.appendChild(i),a.appendChild(l),a.appendChild(d),a.appendChild(o),n.appendChild(a),document.getElementById("games").appendChild(n)}}function getParameterByName(e,t){var n=RegExp("[?&]"+e+"=([^&]*)").exec(t);return n&&decodeURIComponent(n[1].replace(/\+/g," "))}function handleClick(){var e=document.getElementById("sortby"),t=e.options[e.selectedIndex].value,n=document.getElementById("genre"),a=n.options[n.selectedIndex].value;displaySelection(t,a),history.pushState(null,null,"#?sortby="+t+"&genre="+a)}function setSelectedItems(e,t){for(var n=document.getElementById("genre"),a=0;a<n.options.length;a++)if(n.options[a].value==t){n.selectedIndex=a;break}for(var i=document.getElementById("sortby"),d=0;d<i.options.length;d++)if(i.options[d].value==e){i.selectedIndex=d;break}}function checkHash(){if(window.location.hash){var e=window.location.hash.substring(1),t=getParameterByName("sortby",e),n=getParameterByName("genre",e);setSelectedItems(t,n),displaySelection(t,n)}else clearItems()}function displaySelection(e,t){clearItems();var n=window.location.origin+window.location.pathname,a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=JSON.parse(a.responseText);buildHTML(e)}},a.open("GET",n+"/update_games?sortby="+e+"&genre="+t,!0),a.send()}window.onload=checkHash(),window.addEventListener("hashchange",function(){checkHash()});